import{d as e,r as t,o as a,b as l,e as u,k as i,h as s,B as d,u as r,f as n,g as o,m as c,i as v,t as f,l as _,F as p,j as m,n as b}from"./index-IlJQo5zm.js";import{o as y}from"./order-_d18XnoC.js";import{f as x}from"./format--kbnhsCA.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./api-Cql6jV87.js";const h={class:"text-right"},k={class:"text-body-2"},C={class:"text-caption"},w={class:"text-h6 mt-1"},O={class:"text-right"},V={class:"text-h6"},P={class:"text-caption"},j={key:0,class:"text-caption"},z={key:1,class:"text-caption text-disabled"},D={key:0,class:"text-caption"},A={key:1,class:"text-caption text-disabled"},U={key:0,class:"text-caption"},I={key:1,class:"text-caption text-disabled"},R={class:"text-caption"},$={class:"text-caption text-error"},N={key:1,class:"d-flex justify-center align-center",style:{"min-height":"400px"}},S=g(e({__name:"OrderDetail",setup(e){const g=d(),S=r(),q=t(null),T=t(!1),B=t(!1),F=t(!1),M=t(!1),Q=t(""),W=async()=>{T.value=!0;try{const e=parseInt(g.params.id),t=await y.getOrder(e);q.value=t.data}catch(e){}finally{T.value=!1}},E=e=>e.charAt(0).toUpperCase()+e.slice(1),G=e=>x(new Date(e),"PPpp"),H=()=>{F.value=!0},J=async()=>{if(q.value){B.value=!0;try{await y.payOrder(q.value.id),F.value=!1,await W()}catch(e){}finally{B.value=!1}}},K=()=>{M.value=!0},L=async()=>{if(q.value&&Q.value){B.value=!0;try{await y.cancelOrder(q.value.id,Q.value),M.value=!1,Q.value="",await W()}catch(e){}finally{B.value=!1}}},X=async()=>{if(q.value){B.value=!0;try{await y.confirmDelivery(q.value.id),await W()}catch(e){}finally{B.value=!1}}};return a((()=>{W()})),(e,t)=>{const a=n("v-btn"),d=n("v-chip"),r=n("v-card-title"),y=n("v-card-subtitle"),x=n("v-card-item"),g=n("v-card"),T=n("v-col"),W=n("v-row"),Y=n("v-img"),Z=n("v-list-item"),ee=n("v-divider"),te=n("v-list"),ae=n("v-icon"),le=n("v-list-item-title"),ue=n("v-list-item-subtitle"),ie=n("v-card-text"),se=n("v-timeline-item"),de=n("v-timeline"),re=n("v-spacer"),ne=n("v-card-actions"),oe=n("v-dialog"),ce=n("v-textarea"),ve=n("v-container"),fe=n("v-progress-circular");return q.value?(o(),l(ve,{key:0},{default:u((()=>[s(W,null,{default:u((()=>[s(T,{cols:"12"},{default:u((()=>[s(g,{class:"mb-4"},{default:u((()=>[s(x,null,{prepend:u((()=>[s(a,{variant:"text",icon:"mdi-arrow-left",onClick:t[0]||(t[0]=e=>c(S).back())})])),default:u((()=>[s(r,{class:"text-h5"},{default:u((()=>{return[v(" Order Details #"+f(q.value.attributes.id)+" ",1),s(d,{color:(e=q.value.attributes.status,{pending:"warning",paid:"info",shipped:"primary",delivered:"success",cancelled:"error"}[e]),class:"ml-4"},{default:u((()=>[v(f(E(q.value.attributes.status)),1)])),_:1},8,["color"])];var e})),_:1}),s(y,null,{default:u((()=>[v(" Created at "+f(G(q.value.attributes.created_at)),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),s(W,null,{default:u((()=>[s(T,{cols:"12",md:"6"},{default:u((()=>[s(g,{color:"secondary",class:"mb-4",hover:""},{default:u((()=>[s(r,{class:"bg-surface-variant"},{default:u((()=>t[6]||(t[6]=[v(" Order Items ")]))),_:1}),s(te,null,{default:u((()=>[(o(!0),i(p,null,_(q.value.attributes.items,(e=>(o(),l(Z,{key:e.id,title:e.product_name,subtitle:e.description},{prepend:u((()=>[s(Y,{src:e.image_url||"/placeholder.png",width:"100",height:"100",cover:""},null,8,["src"])])),append:u((()=>[m("div",h,[m("div",k," Quantity: "+f(e.quantity),1),m("div",C," Unit Price: $"+f(e.unit_price),1),m("div",w," $"+f(e.total_price),1)])])),_:2},1032,["title","subtitle"])))),128)),s(ee),s(Z,null,{append:u((()=>[m("div",O,[m("div",V," Total Amount: $"+f(q.value.attributes.total_amount),1)])])),_:1})])),_:1})])),_:1}),s(g,null,{default:u((()=>[s(r,{class:"bg-surface-variant",hover:""},{default:u((()=>t[7]||(t[7]=[v(" Shipping Information ")]))),_:1}),s(ie,null,{default:u((()=>[s(te,{density:"compact"},{default:u((()=>[s(Z,null,{prepend:u((()=>[s(ae,null,{default:u((()=>t[8]||(t[8]=[v("mdi-account")]))),_:1})])),default:u((()=>[s(le,null,{default:u((()=>t[9]||(t[9]=[v("Recipient")]))),_:1}),s(ue,null,{default:u((()=>[v(f(q.value.attributes.recipient_name),1)])),_:1})])),_:1}),s(Z,null,{prepend:u((()=>[s(ae,null,{default:u((()=>t[10]||(t[10]=[v("mdi-phone")]))),_:1})])),default:u((()=>[s(le,null,{default:u((()=>t[11]||(t[11]=[v("Phone")]))),_:1}),s(ue,null,{default:u((()=>[v(f(q.value.attributes.phone_number),1)])),_:1})])),_:1}),s(Z,null,{prepend:u((()=>[s(ae,null,{default:u((()=>t[12]||(t[12]=[v("mdi-map-marker")]))),_:1})])),default:u((()=>[s(le,null,{default:u((()=>t[13]||(t[13]=[v("Address")]))),_:1}),s(ue,null,{default:u((()=>[v(f(q.value.attributes.shipping_address),1)])),_:1})])),_:1}),s(Z,null,{prepend:u((()=>[s(ae,null,{default:u((()=>t[14]||(t[14]=[v("mdi-postage-stamp")]))),_:1})])),default:u((()=>[s(le,null,{default:u((()=>t[15]||(t[15]=[v("Postal Code")]))),_:1}),s(ue,null,{default:u((()=>[v(f(q.value.attributes.postal_code),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),s(T,{cols:"12",md:"6"},{default:u((()=>[s(g,{class:"mb-4"},{default:u((()=>[s(r,{class:"bg-surface-variant",hover:""},{default:u((()=>t[16]||(t[16]=[v(" Order Status ")]))),_:1}),s(ie,null,{default:u((()=>[s(de,null,{default:u((()=>[s(se,{"dot-color":"primary",size:"small"},{default:u((()=>[t[17]||(t[17]=m("div",{class:"text-subtitle-2"},"Order Created",-1)),m("div",P,f(G(q.value.attributes.created_at)),1)])),_:1}),s(se,{"dot-color":q.value.attributes.paid_at?"success":"grey",size:"small"},{default:u((()=>[t[18]||(t[18]=m("div",{class:"text-subtitle-2"},"Payment",-1)),q.value.attributes.paid_at?(o(),i("div",j,f(G(q.value.attributes.paid_at)),1)):(o(),i("div",z," Waiting for payment "))])),_:1},8,["dot-color"]),s(se,{"dot-color":q.value.attributes.shipped_at?"info":"grey",size:"small"},{default:u((()=>[t[19]||(t[19]=m("div",{class:"text-subtitle-2"},"Shipping",-1)),q.value.attributes.shipped_at?(o(),i("div",D,f(G(q.value.attributes.shipped_at)),1)):(o(),i("div",A," Not shipped yet "))])),_:1},8,["dot-color"]),s(se,{"dot-color":q.value.attributes.delivered_at?"success":"grey",size:"small"},{default:u((()=>[t[20]||(t[20]=m("div",{class:"text-subtitle-2"},"Delivery",-1)),q.value.attributes.delivered_at?(o(),i("div",U,f(G(q.value.attributes.delivered_at)),1)):(o(),i("div",I," Not delivered yet "))])),_:1},8,["dot-color"]),q.value.attributes.cancelled_at?(o(),l(se,{key:0,"dot-color":"error",size:"small"},{default:u((()=>[t[21]||(t[21]=m("div",{class:"text-subtitle-2"},"Cancelled",-1)),m("div",R,f(G(q.value.attributes.cancelled_at)),1),m("div",$," Reason: "+f(q.value.attributes.cancellation_reason),1)])),_:1})):b("",!0)])),_:1})])),_:1})])),_:1}),s(g,{elevation:"3",rounded:"lg",class:"mb-4"},{default:u((()=>[s(r,{class:"bg-surface-variant text-white rounded-t-lg"},{default:u((()=>[s(ae,{class:"mr-2"},{default:u((()=>t[22]||(t[22]=[v("mdi-cog")]))),_:1}),t[23]||(t[23]=v(" Actions "))])),_:1}),s(ie,{class:"d-flex flex-column align-center py-4"},{default:u((()=>["pending"===q.value.attributes.status?(o(),i(p,{key:0},[s(a,{color:"primary",block:"",class:"mb-3",elevation:"2",large:"",onClick:H},{default:u((()=>[s(ae,{left:""},{default:u((()=>t[24]||(t[24]=[v("mdi-cash")]))),_:1}),t[25]||(t[25]=v(" Pay Now "))])),_:1}),s(a,{color:"error",block:"",elevation:"1",outlined:"",large:"",onClick:K},{default:u((()=>[s(ae,{left:""},{default:u((()=>t[26]||(t[26]=[v("mdi-cancel")]))),_:1}),t[27]||(t[27]=v(" Cancel Order "))])),_:1})],64)):"shipped"===q.value.attributes.status?(o(),l(a,{key:1,color:"success",block:"",elevation:"2",large:"",onClick:X},{default:u((()=>[s(ae,{left:""},{default:u((()=>t[28]||(t[28]=[v("mdi-truck-check")]))),_:1}),t[29]||(t[29]=v(" Confirm Delivery "))])),_:1})):"paid"===q.value.attributes.status?(o(),l(a,{key:2,color:"success",block:"",outlined:"",large:"",disabled:""},{default:u((()=>[s(ae,{left:""},{default:u((()=>t[30]||(t[30]=[v("mdi-check-circle")]))),_:1}),t[31]||(t[31]=v(" 已支付 "))])),_:1})):"delivered"===q.value.attributes.status?(o(),l(a,{key:3,color:"success",block:"",outlined:"",large:"",disabled:""},{default:u((()=>[s(ae,{left:""},{default:u((()=>t[32]||(t[32]=[v("mdi-package-variant-closed")]))),_:1}),t[33]||(t[33]=v(" 已接收 "))])),_:1})):b("",!0)])),_:1}),s(ee),s(y,{class:"text-center text-caption py-2"},{default:u((()=>t[34]||(t[34]=[v(" Manage your order actions here ")]))),_:1})])),_:1})])),_:1})])),_:1}),s(oe,{modelValue:F.value,"onUpdate:modelValue":t[2]||(t[2]=e=>F.value=e),"max-width":"400"},{default:u((()=>[s(g,null,{default:u((()=>[s(r,null,{default:u((()=>t[35]||(t[35]=[v("Confirm Payment")]))),_:1}),s(ie,null,{default:u((()=>[m("p",null,"Total Amount: $"+f(q.value.total_amount),1)])),_:1}),s(ne,null,{default:u((()=>[s(re),s(a,{variant:"text",onClick:t[1]||(t[1]=e=>F.value=!1)},{default:u((()=>t[36]||(t[36]=[v(" Cancel ")]))),_:1}),s(a,{color:"primary",variant:"text",loading:B.value,onClick:J},{default:u((()=>t[37]||(t[37]=[v(" Confirm ")]))),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),s(oe,{modelValue:M.value,"onUpdate:modelValue":t[5]||(t[5]=e=>M.value=e),"max-width":"400"},{default:u((()=>[s(g,null,{default:u((()=>[s(r,null,{default:u((()=>t[38]||(t[38]=[v("Cancel Order")]))),_:1}),s(ie,null,{default:u((()=>[s(ce,{modelValue:Q.value,"onUpdate:modelValue":t[3]||(t[3]=e=>Q.value=e),label:"Cancellation Reason",rules:[e=>!!e||"Reason is required"],rows:"3"},null,8,["modelValue","rules"])])),_:1}),s(ne,null,{default:u((()=>[s(re),s(a,{variant:"text",onClick:t[4]||(t[4]=e=>M.value=!1)},{default:u((()=>t[39]||(t[39]=[v(" Cancel ")]))),_:1}),s(a,{color:"error",variant:"text",loading:B.value,onClick:L},{default:u((()=>t[40]||(t[40]=[v(" Confirm ")]))),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):(o(),i("div",N,[s(fe,{indeterminate:"",size:"64",color:"primary"})]))}}}),[["__scopeId","data-v-63716645"]]);export{S as default};
