import{d as e,r as a,o as t,b as l,e as i,f as s,g as r,h as u,j as d,i as n,C as o,k as c,F as v,l as p,n as m,t as f,p as _}from"./index-RCYdGSFb.js";import{o as y}from"./order-TV5cZrDr.js";import{f as b}from"./format--kbnhsCA.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./api-CfODcUyk.js";const h={class:"d-flex align-center mb-6"},x={class:"text-caption ml-2"},k={class:"shipping-info mb-4"},C={class:"d-flex flex-wrap"},V={class:"d-flex justify-space-between align-center mt-1"},w={class:"text-primary"},O={class:"text-h6"},z={class:"text-caption"},P={class:"text-caption"},j={class:"text-caption"},U={class:"text-caption"},D={class:"text-caption"},R={class:"text-caption text-error"},$={key:0,class:"text-center"},A={class:"text-body-1 mb-6"},N={key:1,class:"d-flex justify-center align-center",style:{"min-height":"400px"}},S={class:"text-h6 mt-2"},q={class:"mb-4"},F=g(e({__name:"OrderList",setup(e){const g=a(!1),F=a(!1),I=a([]),T=a(1),B=a(0),K=a(null),L=a(!1),M=a(!1),Q=a(""),Y=a({status:"",search:"",dateRange:""}),E=[{title:"All Orders",value:""},{title:"Pending",value:"pending"},{title:"Paid",value:"paid"},{title:"Shipped",value:"shipped"},{title:"Delivered",value:"delivered"},{title:"Cancelled",value:"cancelled"}],G=e=>e.charAt(0).toUpperCase()+e.slice(1),H=e=>b(new Date(e),"PPpp"),J=async()=>{g.value=!0;try{const e=await y.getOrders({...Y.value,page:T.value});I.value=e.data,B.value=e.meta.total_pages}catch(e){}finally{g.value=!1}},W=async()=>{if(K.value){F.value=!0;try{await y.payOrder(K.value.id),L.value=!1,await J()}catch(e){}finally{F.value=!1}}},X=async()=>{if(K.value&&Q.value){F.value=!0;try{await y.cancelOrder(K.value.id,Q.value),M.value=!1,Q.value="",await J()}catch(e){}finally{F.value=!1}}};return t((()=>{J()})),(e,a)=>{const t=s("v-icon"),b=s("v-spacer"),Z=s("v-btn"),ee=s("v-col"),ae=s("v-row"),te=s("v-select"),le=s("v-text-field"),ie=s("v-chip"),se=s("v-card-title"),re=s("v-card-subtitle"),ue=s("v-card-item"),de=s("v-divider"),ne=s("v-img"),oe=s("v-avatar"),ce=s("v-list-item"),ve=s("v-list"),pe=s("v-expansion-panel"),me=s("v-expansion-panels"),fe=s("v-timeline-item"),_e=s("v-timeline"),ye=s("v-card-text"),be=s("v-card-actions"),ge=s("v-card"),he=s("v-pagination"),xe=s("v-progress-circular"),ke=s("v-dialog"),Ce=s("v-textarea"),Ve=s("v-container");return r(),l(Ve,null,{default:i((()=>[u(ae,null,{default:i((()=>[u(ee,{cols:"12"},{default:i((()=>[d("div",h,[u(t,{icon:"mdi-file-document-outline",size:"x-large",class:"me-3"}),a[10]||(a[10]=d("h1",{class:"text-h4 mb-0"},"My Orders",-1)),u(b),u(Z,{"prepend-icon":"mdi-refresh",onClick:J,loading:g.value},{default:i((()=>a[9]||(a[9]=[n(" Refresh ")]))),_:1},8,["loading"])])])),_:1})])),_:1}),u(ae,{class:"mb-4"},{default:i((()=>[u(ee,{cols:"12",sm:"4"},{default:i((()=>[u(te,{modelValue:Y.value.status,"onUpdate:modelValue":[a[0]||(a[0]=e=>Y.value.status=e),J],items:E,label:"Status",clearable:""},null,8,["modelValue"])])),_:1}),u(ee,{cols:"12",sm:"4"},{default:i((()=>[u(le,{modelValue:Y.value.search,"onUpdate:modelValue":a[1]||(a[1]=e=>Y.value.search=e),label:"Search orders","prepend-inner-icon":"mdi-magnify",clearable:"",onKeyup:o(J,["enter"])},null,8,["modelValue"])])),_:1}),u(ee,{cols:"12",sm:"4"},{default:i((()=>[u(le,{modelValue:Y.value.dateRange,"onUpdate:modelValue":[a[2]||(a[2]=e=>Y.value.dateRange=e),J],label:"Date range",type:"date",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),g.value?(r(),c("div",N,[u(xe,{indeterminate:"",size:"64",color:"primary"})])):(r(),c(v,{key:0},[I.value.length?(r(),c(v,{key:0},[(r(!0),c(v,null,p(I.value,(e=>(r(),l(ge,{key:e.id,class:_(["mb-4",{cancelled:"cancelled"===e.attributes.status}])},{default:i((()=>[u(ue,null,{prepend:i((()=>{return[u(ie,{color:(a=e.attributes.status,{pending:"warning",paid:"info",shipped:"primary",delivered:"success",cancelled:"error"}[a]),label:""},{default:i((()=>[n(f(G(e.attributes.status)),1)])),_:2},1032,["color"])];var a})),default:i((()=>[u(se,null,{default:i((()=>[n(" Order #"+f(e.attributes.id)+" ",1),d("span",x,f(H(e.attributes.created_at)),1)])),_:2},1024),u(re,null,{default:i((()=>[n(" Total: $"+f(e.attributes.total_amount)+" Â· "+f(e.attributes.items.length)+" items ",1)])),_:2},1024)])),_:2},1024),u(de),u(ye,null,{default:i((()=>[d("div",k,[d("div",C,[u(ie,{class:"me-2 mb-2","prepend-icon":"mdi-account"},{default:i((()=>[n(f(e.attributes.recipient_name),1)])),_:2},1024),u(ie,{class:"me-2 mb-2","prepend-icon":"mdi-phone"},{default:i((()=>[n(f(e.attributes.phone_number),1)])),_:2},1024),u(ie,{class:"me-2 mb-2","prepend-icon":"mdi-map-marker"},{default:i((()=>[n(f(e.attributes.shipping_address),1)])),_:2},1024),u(ie,{class:"mb-2","prepend-icon":"mdi-postage-stamp"},{default:i((()=>[n(f(e.attributes.postal_code),1)])),_:2},1024)])]),u(me,null,{default:i((()=>[u(pe,{title:"Order Items",text:`${e.attributes.items.length} items`},{text:i((()=>[u(ve,null,{default:i((()=>[(r(!0),c(v,null,p(e.attributes.items,(e=>(r(),l(ce,{key:e.id,title:e.product_name},{prepend:i((()=>[u(oe,{rounded:"0",size:"80"},{default:i((()=>[u(ne,{src:e.image_url||"/placeholder.png"},null,8,["src"])])),_:2},1024)])),subtitle:i((()=>[d("div",V,[d("span",null,"Quantity: "+f(e.quantity),1),d("span",w,"$"+f(e.unit_price)+" each",1)])])),append:i((()=>[d("div",O,"$"+f(e.total_price),1)])),_:2},1032,["title"])))),128))])),_:2},1024)])),_:2},1032,["text"])])),_:2},1024),u(_e,{class:"mt-4",density:"compact"},{default:i((()=>[u(fe,{"dot-color":"primary",size:"small"},{default:i((()=>[d("div",z," Created: "+f(H(e.attributes.created_at)),1)])),_:2},1024),e.attributes.paid_at?(r(),l(fe,{key:0,"dot-color":"success",size:"small"},{default:i((()=>[d("div",P," Paid: "+f(H(e.attributes.paid_at)),1)])),_:2},1024)):m("",!0),e.attributes.shipped_at?(r(),l(fe,{key:1,"dot-color":"info",size:"small"},{default:i((()=>[d("div",j," Shipped: "+f(H(e.attributes.shipped_at)),1)])),_:2},1024)):m("",!0),e.attributes.delivered_at?(r(),l(fe,{key:2,"dot-color":"success",size:"small"},{default:i((()=>[d("div",U," Delivered: "+f(H(e.attributes.delivered_at)),1)])),_:2},1024)):m("",!0),e.attributes.cancelled_at?(r(),l(fe,{key:3,"dot-color":"error",size:"small"},{default:i((()=>[d("div",D," Cancelled: "+f(H(e.attributes.cancelled_at)),1),d("div",R," Reason: "+f(e.attributes.cancellation_reason),1)])),_:2},1024)):m("",!0)])),_:2},1024)])),_:2},1024),u(de),u(be,null,{default:i((()=>[u(b),"pending"===e.attributes.status?(r(),c(v,{key:0},[u(Z,{color:"primary",variant:"text",onClick:a=>(e=>{K.value=e,L.value=!0})(e)},{default:i((()=>a[11]||(a[11]=[n(" Pay Now ")]))),_:2},1032,["onClick"]),u(Z,{color:"error",variant:"text",onClick:a=>(e=>{K.value=e,M.value=!0})(e)},{default:i((()=>a[12]||(a[12]=[n(" Cancel Order ")]))),_:2},1032,["onClick"])],64)):m("",!0),"shipped"===e.attributes.status?(r(),l(Z,{key:1,color:"success",variant:"text",onClick:a=>(async e=>{F.value=!0;try{await y.confirmDelivery(e.id),await J()}catch(a){}finally{F.value=!1}})(e)},{default:i((()=>a[13]||(a[13]=[n(" Confirm Delivery ")]))),_:2},1032,["onClick"])):m("",!0),u(Z,{variant:"text",to:`/orders/${e.id}`},{default:i((()=>a[14]||(a[14]=[n(" View Details ")]))),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["class"])))),128)),B.value>1?(r(),c("div",$,[u(he,{modelValue:T.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>T.value=e),J],length:B.value},null,8,["modelValue","length"])])):m("",!0)],64)):(r(),l(ge,{key:1,class:"text-center pa-12"},{default:i((()=>[u(t,{icon:"mdi-package-variant",size:"100",color:"grey-lighten-1",class:"mb-4"}),a[16]||(a[16]=d("h3",{class:"text-h5 mb-2"},"No Orders Found",-1)),d("p",A,f(Y.value.status?`No ${Y.value.status} orders found.`:"Start shopping to create your first order!"),1),u(Z,{color:"primary",size:"large",to:"/products","prepend-icon":"mdi-shopping"},{default:i((()=>a[15]||(a[15]=[n(" Browse Products ")]))),_:1})])),_:1}))],64)),u(ke,{modelValue:L.value,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value=e),"max-width":"400"},{default:i((()=>[u(ge,null,{default:i((()=>[u(se,null,{default:i((()=>a[17]||(a[17]=[n("Confirm Payment")]))),_:1}),u(ye,null,{default:i((()=>{var e,a;return[n(" Are you sure you want to pay for Order #"+f(null==(e=K.value)?void 0:e.id)+"? ",1),d("div",S," Total Amount: $"+f(null==(a=K.value)?void 0:a.total_amount),1)]})),_:1}),u(be,null,{default:i((()=>[u(b),u(Z,{variant:"text",onClick:a[4]||(a[4]=e=>L.value=!1)},{default:i((()=>a[18]||(a[18]=[n(" Cancel ")]))),_:1}),u(Z,{color:"primary",variant:"text",loading:F.value,onClick:W},{default:i((()=>a[19]||(a[19]=[n(" Pay Now ")]))),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),u(ke,{modelValue:M.value,"onUpdate:modelValue":a[8]||(a[8]=e=>M.value=e),"max-width":"400"},{default:i((()=>[u(ge,null,{default:i((()=>[u(se,null,{default:i((()=>a[20]||(a[20]=[n("Cancel Order")]))),_:1}),u(ye,null,{default:i((()=>{var e;return[d("p",q,"Are you sure you want to cancel Order #"+f(null==(e=K.value)?void 0:e.id)+"?",1),u(Ce,{modelValue:Q.value,"onUpdate:modelValue":a[6]||(a[6]=e=>Q.value=e),label:"Cancellation Reason",rows:"3",rules:[e=>!!e||"Reason is required"]},null,8,["modelValue","rules"])]})),_:1}),u(be,null,{default:i((()=>[u(b),u(Z,{variant:"text",onClick:a[7]||(a[7]=e=>M.value=!1)},{default:i((()=>a[21]||(a[21]=[n(" No ")]))),_:1}),u(Z,{color:"error",variant:"text",loading:F.value,onClick:X},{default:i((()=>a[22]||(a[22]=[n(" Yes, Cancel ")]))),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-216e4f80"]]);export{F as default};
