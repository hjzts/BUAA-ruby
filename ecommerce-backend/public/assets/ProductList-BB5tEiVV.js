import{d as te,r as i,c as le,o as ae,w as oe,b as ne,e as a,f as n,g as ue,h as t,j as S,i as s,m as re,t as I,y as ie}from"./index-B0vVrGoP.js";import{d as se,p as _}from"./product-DW-W9-od.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"d-flex justify-space-between align-center mb-4"},me={class:"text-center pt-4"},ve=te({__name:"ProductList",setup(pe){const k=i(!1),m=i(!1),f=i(!1),U=i([]),g=i(null),b=i(1),y=i(null),v=i(1),$=i(1),d=i({search:"",available:!1,min_price:0,max_price:1e3}),x=le({get:()=>[d.value.min_price,d.value.max_price],set:o=>{[d.value.min_price,d.value.max_price]=o}}),z=[{title:"Image",key:"image_url",sortable:!1},{title:"Name",key:"product_name"},{title:"Price",key:"price"},{title:"Stock",key:"stock_quantity"},{title:"Sales",key:"sales_count"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],u=i({product_name:"",description:"",price:0,stock_quantity:0,image:null}),c=async()=>{k.value=!0;try{const o=await _.getProducts({page:v.value,...d.value});U.value=o.products.map(e=>({id:Number(e.id),...e.attributes})),$.value=o.meta.total_pages}catch(o){console.error("Failed to fetch products:",o)}finally{k.value=!1}},j=se(()=>{v.value=1,c()},300),B=o=>({active:"success",inactive:"warning",deleted:"error"})[o],E=o=>{g.value=o,u.value={...o,image:null},m.value=!0},L=o=>{y.value=o,f.value=!0},A=async()=>{try{const o=new FormData;Object.entries(u.value).forEach(([e,r])=>{r!==null&&o.append(e,r)}),g.value?await _.updateProduct(g.value.id,o):await _.createProduct(o),await c(),m.value=!1}catch(o){console.error("Failed to save product:",o)}},O=async o=>{if(confirm("Are you sure you want to delete this product?"))try{await _.deleteProduct(o.id),await c()}catch(e){console.error("Failed to delete product:",e)}},D=async o=>{if(!(!y.value||b.value<=0))try{await _.manageStock(y.value.id,o,b.value),await c(),f.value=!1}catch(e){console.error("Failed to manage stock:",e)}};return ae(()=>{c()}),oe(()=>[d.value.available,x.value],()=>{v.value=1,c()}),(o,e)=>{const r=n("v-btn"),p=n("v-text-field"),V=n("v-col"),R=n("v-select"),Q=n("v-range-slider"),q=n("v-row"),w=n("v-card-text"),P=n("v-card"),T=n("v-img"),G=n("v-chip"),C=n("v-icon"),H=n("v-data-table"),J=n("v-pagination"),M=n("v-card-title"),K=n("v-textarea"),W=n("v-file-input"),X=n("v-form"),Y=n("v-spacer"),Z=n("v-card-actions"),N=n("v-dialog"),h=n("v-btn-group"),ee=n("v-container");return ue(),ne(ee,{fluid:""},{default:a(()=>[t(q,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[S("div",ce,[e[17]||(e[17]=S("h1",{class:"text-h4"},"Products Management",-1)),t(r,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=l=>m.value=!0)},{default:a(()=>e[16]||(e[16]=[s(" Add Product ")])),_:1})]),t(P,{class:"mb-4"},{default:a(()=>[t(w,null,{default:a(()=>[t(q,null,{default:a(()=>[t(V,{cols:"12",sm:"4"},{default:a(()=>[t(p,{modelValue:d.value.search,"onUpdate:modelValue":[e[1]||(e[1]=l=>d.value.search=l),re(j)],label:"Search products","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(V,{cols:"12",sm:"4"},{default:a(()=>[t(R,{modelValue:d.value.available,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value.available=l),items:[{title:"All Products",value:null},{title:"Available",value:!0},{title:"Out of Stock",value:!1}],label:"Availability","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"4"},{default:a(()=>[t(Q,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=l=>x.value=l),min:0,max:1e3,step:10,label:"Price Range","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(H,{headers:z,items:U.value,loading:k.value,class:"elevation-1"},{"item.image_url":a(({item:l})=>[t(T,{src:l.image_url||"/placeholder.png",height:"50",width:"50",cover:""},null,8,["src"])]),"item.price":a(({item:l})=>[s(" $"+I(l.price),1)]),"item.status":a(({item:l})=>[t(G,{color:B(l.status),text:l.status,size:"small"},null,8,["color","text"])]),"item.actions":a(({item:l})=>[t(r,{icon:"",variant:"text",size:"small",color:"primary",onClick:F=>E(l)},{default:a(()=>[t(C,null,{default:a(()=>e[18]||(e[18]=[s("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),t(r,{icon:"",variant:"text",size:"small",color:"error",onClick:F=>O(l)},{default:a(()=>[t(C,null,{default:a(()=>e[19]||(e[19]=[s("mdi-delete")])),_:1})]),_:2},1032,["onClick"]),t(r,{icon:"",variant:"text",size:"small",color:"info",onClick:F=>L(l)},{default:a(()=>[t(C,null,{default:a(()=>e[20]||(e[20]=[s("mdi-package-variant")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"]),S("div",me,[t(J,{modelValue:v.value,"onUpdate:modelValue":[e[4]||(e[4]=l=>v.value=l),c],length:$.value},null,8,["modelValue","length"])])]),_:1})]),_:1}),t(N,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=l=>m.value=l),"max-width":"600px"},{default:a(()=>[t(P,null,{default:a(()=>[t(M,null,{default:a(()=>[s(I(g.value?"Edit Product":"New Product"),1)]),_:1}),t(w,null,{default:a(()=>[t(X,{onSubmit:ie(A,["prevent"]),ref:"form"},{default:a(()=>[t(p,{modelValue:u.value.product_name,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.product_name=l),label:"Product Name",required:""},null,8,["modelValue"]),t(K,{modelValue:u.value.description,"onUpdate:modelValue":e[6]||(e[6]=l=>u.value.description=l),label:"Description"},null,8,["modelValue"]),t(p,{modelValue:u.value.price,"onUpdate:modelValue":e[7]||(e[7]=l=>u.value.price=l),modelModifiers:{number:!0},label:"Price",type:"number",prefix:"$",required:""},null,8,["modelValue"]),t(p,{modelValue:u.value.stock_quantity,"onUpdate:modelValue":e[8]||(e[8]=l=>u.value.stock_quantity=l),modelModifiers:{number:!0},label:"Stock Quantity",type:"number",required:""},null,8,["modelValue"]),t(W,{modelValue:u.value.image,"onUpdate:modelValue":e[9]||(e[9]=l=>u.value.image=l),label:"Product Image",accept:"image/*","prepend-icon":"mdi-camera"},null,8,["modelValue"])]),_:1},512)]),_:1}),t(Z,null,{default:a(()=>[t(Y),t(r,{color:"grey-darken-1",variant:"text",onClick:e[10]||(e[10]=l=>m.value=!1)},{default:a(()=>e[21]||(e[21]=[s(" Cancel ")])),_:1}),t(r,{color:"primary",variant:"text",onClick:A},{default:a(()=>e[22]||(e[22]=[s(" Save ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{modelValue:f.value,"onUpdate:modelValue":e[15]||(e[15]=l=>f.value=l),"max-width":"400px"},{default:a(()=>[t(P,null,{default:a(()=>[t(M,null,{default:a(()=>e[23]||(e[23]=[s("Manage Stock")])),_:1}),t(w,null,{default:a(()=>[t(p,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=l=>b.value=l),modelModifiers:{number:!0},label:"Amount",type:"number",min:"1"},null,8,["modelValue"]),t(h,{variant:"outlined"},{default:a(()=>[t(r,{color:"success","prepend-icon":"mdi-plus",onClick:e[13]||(e[13]=l=>D("increase"))},{default:a(()=>e[24]||(e[24]=[s(" Increase ")])),_:1}),t(r,{color:"error","prepend-icon":"mdi-minus",onClick:e[14]||(e[14]=l=>D("decrease"))},{default:a(()=>e[25]||(e[25]=[s(" Decrease ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),be=de(ve,[["__scopeId","data-v-b156c873"]]);export{be as default};
