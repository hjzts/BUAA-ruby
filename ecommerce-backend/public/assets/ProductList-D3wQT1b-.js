import{d as e,r as l,c as a,o as t,w as u,b as i,e as o,f as d,g as n,h as r,j as c,i as s,m,t as v,y as p}from"./index-RCYdGSFb.js";import{d as _,p as f}from"./product-CxGzDVNC.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";const V={class:"d-flex justify-space-between align-center mb-4"},b={class:"text-center pt-4"},y=g(e({__name:"ProductList",setup(e){const g=l(!1),y=l(!1),k=l(!1),h=l([]),x=l(null),w=l(1),P=l(null),U=l(1),C=l(1),S=l({search:"",available:!1,min_price:0,max_price:1e3}),q=a({get:()=>[S.value.min_price,S.value.max_price],set:e=>{[S.value.min_price,S.value.max_price]=e}}),A=[{title:"Image",key:"image_url",sortable:!1},{title:"Name",key:"product_name"},{title:"Price",key:"price"},{title:"Stock",key:"stock_quantity"},{title:"Sales",key:"sales_count"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],j=l({product_name:"",description:"",price:0,stock_quantity:0,image:null}),M=async()=>{g.value=!0;try{const e=await f.getProducts({page:U.value,...S.value});h.value=e.products.map((e=>({id:Number(e.id),...e.attributes}))),C.value=e.meta.total_pages}catch(e){}finally{g.value=!1}},z=_((()=>{U.value=1,M()}),300),I=async()=>{try{const e=new FormData;Object.entries(j.value).forEach((([l,a])=>{null!==a&&e.append(l,a)})),x.value?await f.updateProduct(x.value.id,e):await f.createProduct(e),await M(),y.value=!1}catch(e){}},N=async e=>{if(P.value&&!(w.value<=0))try{await f.manageStock(P.value.id,e,w.value),await M(),k.value=!1}catch(l){}};return t((()=>{M()})),u((()=>[S.value.available,q.value]),(()=>{U.value=1,M()})),(e,l)=>{const a=d("v-btn"),t=d("v-text-field"),u=d("v-col"),_=d("v-select"),D=d("v-range-slider"),E=d("v-row"),O=d("v-card-text"),$=d("v-card"),F=d("v-img"),L=d("v-chip"),Q=d("v-icon"),R=d("v-data-table"),B=d("v-pagination"),G=d("v-card-title"),H=d("v-textarea"),J=d("v-file-input"),K=d("v-form"),T=d("v-spacer"),W=d("v-card-actions"),X=d("v-dialog"),Y=d("v-btn-group"),Z=d("v-container");return n(),i(Z,{fluid:""},{default:o((()=>[r(E,null,{default:o((()=>[r(u,{cols:"12"},{default:o((()=>[c("div",V,[l[17]||(l[17]=c("h1",{class:"text-h4"},"Products Management",-1)),r(a,{color:"primary","prepend-icon":"mdi-plus",onClick:l[0]||(l[0]=e=>y.value=!0)},{default:o((()=>l[16]||(l[16]=[s(" Add Product ")]))),_:1})]),r($,{class:"mb-4"},{default:o((()=>[r(O,null,{default:o((()=>[r(E,null,{default:o((()=>[r(u,{cols:"12",sm:"4"},{default:o((()=>[r(t,{modelValue:S.value.search,"onUpdate:modelValue":[l[1]||(l[1]=e=>S.value.search=e),m(z)],label:"Search products","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),r(u,{cols:"12",sm:"4"},{default:o((()=>[r(_,{modelValue:S.value.available,"onUpdate:modelValue":l[2]||(l[2]=e=>S.value.available=e),items:[{title:"All Products",value:null},{title:"Available",value:!0},{title:"Out of Stock",value:!1}],label:"Availability","hide-details":""},null,8,["modelValue"])])),_:1}),r(u,{cols:"12",sm:"4"},{default:o((()=>[r(D,{modelValue:q.value,"onUpdate:modelValue":l[3]||(l[3]=e=>q.value=e),min:0,max:1e3,step:10,label:"Price Range","hide-details":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),r(R,{headers:A,items:h.value,loading:g.value,class:"elevation-1"},{"item.image_url":o((({item:e})=>[r(F,{src:e.image_url||"/placeholder.png",height:"50",width:"50",cover:""},null,8,["src"])])),"item.price":o((({item:e})=>[s(" $"+v(e.price),1)])),"item.status":o((({item:e})=>{return[r(L,{color:(l=e.status,{active:"success",inactive:"warning",deleted:"error"}[l]),text:e.status,size:"small"},null,8,["color","text"])];var l})),"item.actions":o((({item:e})=>[r(a,{icon:"",variant:"text",size:"small",color:"primary",onClick:l=>(e=>{x.value=e,j.value={...e,image:null},y.value=!0})(e)},{default:o((()=>[r(Q,null,{default:o((()=>l[18]||(l[18]=[s("mdi-pencil")]))),_:1})])),_:2},1032,["onClick"]),r(a,{icon:"",variant:"text",size:"small",color:"error",onClick:l=>(async e=>{if(confirm("Are you sure you want to delete this product?"))try{await f.deleteProduct(e.id),await M()}catch(l){}})(e)},{default:o((()=>[r(Q,null,{default:o((()=>l[19]||(l[19]=[s("mdi-delete")]))),_:1})])),_:2},1032,["onClick"]),r(a,{icon:"",variant:"text",size:"small",color:"info",onClick:l=>(e=>{P.value=e,k.value=!0})(e)},{default:o((()=>[r(Q,null,{default:o((()=>l[20]||(l[20]=[s("mdi-package-variant")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1032,["items","loading"]),c("div",b,[r(B,{modelValue:U.value,"onUpdate:modelValue":[l[4]||(l[4]=e=>U.value=e),M],length:C.value},null,8,["modelValue","length"])])])),_:1})])),_:1}),r(X,{modelValue:y.value,"onUpdate:modelValue":l[11]||(l[11]=e=>y.value=e),"max-width":"600px"},{default:o((()=>[r($,null,{default:o((()=>[r(G,null,{default:o((()=>[s(v(x.value?"Edit Product":"New Product"),1)])),_:1}),r(O,null,{default:o((()=>[r(K,{onSubmit:p(I,["prevent"]),ref:"form"},{default:o((()=>[r(t,{modelValue:j.value.product_name,"onUpdate:modelValue":l[5]||(l[5]=e=>j.value.product_name=e),label:"Product Name",required:""},null,8,["modelValue"]),r(H,{modelValue:j.value.description,"onUpdate:modelValue":l[6]||(l[6]=e=>j.value.description=e),label:"Description"},null,8,["modelValue"]),r(t,{modelValue:j.value.price,"onUpdate:modelValue":l[7]||(l[7]=e=>j.value.price=e),modelModifiers:{number:!0},label:"Price",type:"number",prefix:"$",required:""},null,8,["modelValue"]),r(t,{modelValue:j.value.stock_quantity,"onUpdate:modelValue":l[8]||(l[8]=e=>j.value.stock_quantity=e),modelModifiers:{number:!0},label:"Stock Quantity",type:"number",required:""},null,8,["modelValue"]),r(J,{modelValue:j.value.image,"onUpdate:modelValue":l[9]||(l[9]=e=>j.value.image=e),label:"Product Image",accept:"image/*","prepend-icon":"mdi-camera"},null,8,["modelValue"])])),_:1},512)])),_:1}),r(W,null,{default:o((()=>[r(T),r(a,{color:"grey-darken-1",variant:"text",onClick:l[10]||(l[10]=e=>y.value=!1)},{default:o((()=>l[21]||(l[21]=[s(" Cancel ")]))),_:1}),r(a,{color:"primary",variant:"text",onClick:I},{default:o((()=>l[22]||(l[22]=[s(" Save ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),r(X,{modelValue:k.value,"onUpdate:modelValue":l[15]||(l[15]=e=>k.value=e),"max-width":"400px"},{default:o((()=>[r($,null,{default:o((()=>[r(G,null,{default:o((()=>l[23]||(l[23]=[s("Manage Stock")]))),_:1}),r(O,null,{default:o((()=>[r(t,{modelValue:w.value,"onUpdate:modelValue":l[12]||(l[12]=e=>w.value=e),modelModifiers:{number:!0},label:"Amount",type:"number",min:"1"},null,8,["modelValue"]),r(Y,{variant:"outlined"},{default:o((()=>[r(a,{color:"success","prepend-icon":"mdi-plus",onClick:l[13]||(l[13]=e=>N("increase"))},{default:o((()=>l[24]||(l[24]=[s(" Increase ")]))),_:1}),r(a,{color:"error","prepend-icon":"mdi-minus",onClick:l[14]||(l[14]=e=>N("decrease"))},{default:o((()=>l[25]||(l[25]=[s(" Decrease ")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-b156c873"]]);export{y as default};
