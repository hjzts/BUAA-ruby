import{d as pe,r as p,o as _e,b as f,e as t,f as n,g as d,h as e,j as r,i,C as ve,k as y,F as O,l as K,n as b,t as s,p as me}from"./index-B0vVrGoP.js";import{o as N}from"./order-CEDnoQ5w.js";import{f as fe}from"./format-BzRktsyD.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./api-D7B8soog.js";const ye={class:"d-flex align-center mb-6"},be={class:"text-caption ml-2"},xe={class:"shipping-info mb-4"},ke={class:"d-flex flex-wrap"},Ce={class:"d-flex justify-space-between align-center mt-1"},we={class:"text-primary"},Ve={class:"text-h6"},he={class:"text-caption"},Oe={class:"text-caption"},De={class:"text-caption"},$e={class:"text-caption"},ze={class:"text-caption"},Pe={class:"text-caption text-error"},Se={key:0,class:"text-center"},Ne={class:"text-body-1 mb-6"},Re={key:1,class:"d-flex justify-center align-center",style:{"min-height":"400px"}},Ue={class:"text-h6 mt-2"},Fe={class:"mb-4"},Ae=pe({__name:"OrderList",setup(Be){const D=p(!1),g=p(!1),$=p([]),R=p(1),U=p(0),_=p(null),k=p(!1),C=p(!1),w=p(""),v=p({status:"",search:"",dateRange:""}),M=[{title:"All Orders",value:""},{title:"Pending",value:"pending"},{title:"Paid",value:"paid"},{title:"Shipped",value:"shipped"},{title:"Delivered",value:"delivered"},{title:"Cancelled",value:"cancelled"}],E=o=>({pending:"warning",paid:"info",shipped:"primary",delivered:"success",cancelled:"error"})[o],Q=o=>o.charAt(0).toUpperCase()+o.slice(1),x=o=>fe(new Date(o),"PPpp"),m=async()=>{D.value=!0;try{const o=await N.getOrders({...v.value,page:R.value});$.value=o.data,console.log("orders: ",$.value),console.log("get order response: ",o),U.value=o.meta.total_pages}catch(o){console.error("Failed to fetch orders:",o)}finally{D.value=!1}},Y=o=>{_.value=o,k.value=!0},G=async()=>{if(_.value){g.value=!0;try{await N.payOrder(_.value.id),k.value=!1,await m()}catch(o){console.error("Failed to pay order:",o)}finally{g.value=!1}}},H=o=>{_.value=o,C.value=!0},J=async()=>{if(!(!_.value||!w.value)){g.value=!0;try{await N.cancelOrder(_.value.id,w.value),C.value=!1,w.value="",await m()}catch(o){console.error("Failed to cancel order:",o)}finally{g.value=!1}}},W=async o=>{g.value=!0;try{await N.confirmDelivery(o.id),await m()}catch(l){console.error("Failed to confirm delivery:",l)}finally{g.value=!1}};return _e(()=>{m()}),(o,l)=>{const T=n("v-icon"),z=n("v-spacer"),c=n("v-btn"),P=n("v-col"),j=n("v-row"),X=n("v-select"),L=n("v-text-field"),V=n("v-chip"),F=n("v-card-title"),Z=n("v-card-subtitle"),ee=n("v-card-item"),q=n("v-divider"),te=n("v-img"),ae=n("v-avatar"),le=n("v-list-item"),ne=n("v-list"),oe=n("v-expansion-panel"),se=n("v-expansion-panels"),h=n("v-timeline-item"),ie=n("v-timeline"),A=n("v-card-text"),B=n("v-card-actions"),S=n("v-card"),re=n("v-pagination"),ue=n("v-progress-circular"),I=n("v-dialog"),de=n("v-textarea"),ce=n("v-container");return d(),f(ce,null,{default:t(()=>[e(j,null,{default:t(()=>[e(P,{cols:"12"},{default:t(()=>[r("div",ye,[e(T,{icon:"mdi-file-document-outline",size:"x-large",class:"me-3"}),l[10]||(l[10]=r("h1",{class:"text-h4 mb-0"},"My Orders",-1)),e(z),e(c,{"prepend-icon":"mdi-refresh",onClick:m,loading:D.value},{default:t(()=>l[9]||(l[9]=[i(" Refresh ")])),_:1},8,["loading"])])]),_:1})]),_:1}),e(j,{class:"mb-4"},{default:t(()=>[e(P,{cols:"12",sm:"4"},{default:t(()=>[e(X,{modelValue:v.value.status,"onUpdate:modelValue":[l[0]||(l[0]=a=>v.value.status=a),m],items:M,label:"Status",clearable:""},null,8,["modelValue"])]),_:1}),e(P,{cols:"12",sm:"4"},{default:t(()=>[e(L,{modelValue:v.value.search,"onUpdate:modelValue":l[1]||(l[1]=a=>v.value.search=a),label:"Search orders","prepend-inner-icon":"mdi-magnify",clearable:"",onKeyup:ve(m,["enter"])},null,8,["modelValue"])]),_:1}),e(P,{cols:"12",sm:"4"},{default:t(()=>[e(L,{modelValue:v.value.dateRange,"onUpdate:modelValue":[l[2]||(l[2]=a=>v.value.dateRange=a),m],label:"Date range",type:"date",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),D.value?(d(),y("div",Re,[e(ue,{indeterminate:"",size:"64",color:"primary"})])):(d(),y(O,{key:0},[$.value.length?(d(),y(O,{key:0},[(d(!0),y(O,null,K($.value,a=>(d(),f(S,{key:a.id,class:me(["mb-4",{cancelled:a.attributes.status==="cancelled"}])},{default:t(()=>[e(ee,null,{prepend:t(()=>[e(V,{color:E(a.attributes.status),label:""},{default:t(()=>[i(s(Q(a.attributes.status)),1)]),_:2},1032,["color"])]),default:t(()=>[e(F,null,{default:t(()=>[i(" Order #"+s(a.attributes.id)+" ",1),r("span",be,s(x(a.attributes.created_at)),1)]),_:2},1024),e(Z,null,{default:t(()=>[i(" Total: $"+s(a.attributes.total_amount)+" Â· "+s(a.attributes.items.length)+" items ",1)]),_:2},1024)]),_:2},1024),e(q),e(A,null,{default:t(()=>[r("div",xe,[r("div",ke,[e(V,{class:"me-2 mb-2","prepend-icon":"mdi-account"},{default:t(()=>[i(s(a.attributes.recipient_name),1)]),_:2},1024),e(V,{class:"me-2 mb-2","prepend-icon":"mdi-phone"},{default:t(()=>[i(s(a.attributes.phone_number),1)]),_:2},1024),e(V,{class:"me-2 mb-2","prepend-icon":"mdi-map-marker"},{default:t(()=>[i(s(a.attributes.shipping_address),1)]),_:2},1024),e(V,{class:"mb-2","prepend-icon":"mdi-postage-stamp"},{default:t(()=>[i(s(a.attributes.postal_code),1)]),_:2},1024)])]),e(se,null,{default:t(()=>[e(oe,{title:"Order Items",text:`${a.attributes.items.length} items`},{text:t(()=>[e(ne,null,{default:t(()=>[(d(!0),y(O,null,K(a.attributes.items,u=>(d(),f(le,{key:u.id,title:u.product_name},{prepend:t(()=>[e(ae,{rounded:"0",size:"80"},{default:t(()=>[e(te,{src:u.image_url||"/placeholder.png"},null,8,["src"])]),_:2},1024)]),subtitle:t(()=>[r("div",Ce,[r("span",null,"Quantity: "+s(u.quantity),1),r("span",we,"$"+s(u.unit_price)+" each",1)])]),append:t(()=>[r("div",Ve,"$"+s(u.total_price),1)]),_:2},1032,["title"]))),128))]),_:2},1024)]),_:2},1032,["text"])]),_:2},1024),e(ie,{class:"mt-4",density:"compact"},{default:t(()=>[e(h,{"dot-color":"primary",size:"small"},{default:t(()=>[r("div",he," Created: "+s(x(a.attributes.created_at)),1)]),_:2},1024),a.attributes.paid_at?(d(),f(h,{key:0,"dot-color":"success",size:"small"},{default:t(()=>[r("div",Oe," Paid: "+s(x(a.attributes.paid_at)),1)]),_:2},1024)):b("",!0),a.attributes.shipped_at?(d(),f(h,{key:1,"dot-color":"info",size:"small"},{default:t(()=>[r("div",De," Shipped: "+s(x(a.attributes.shipped_at)),1)]),_:2},1024)):b("",!0),a.attributes.delivered_at?(d(),f(h,{key:2,"dot-color":"success",size:"small"},{default:t(()=>[r("div",$e," Delivered: "+s(x(a.attributes.delivered_at)),1)]),_:2},1024)):b("",!0),a.attributes.cancelled_at?(d(),f(h,{key:3,"dot-color":"error",size:"small"},{default:t(()=>[r("div",ze," Cancelled: "+s(x(a.attributes.cancelled_at)),1),r("div",Pe," Reason: "+s(a.attributes.cancellation_reason),1)]),_:2},1024)):b("",!0)]),_:2},1024)]),_:2},1024),e(q),e(B,null,{default:t(()=>[e(z),a.attributes.status==="pending"?(d(),y(O,{key:0},[e(c,{color:"primary",variant:"text",onClick:u=>Y(a)},{default:t(()=>l[11]||(l[11]=[i(" Pay Now ")])),_:2},1032,["onClick"]),e(c,{color:"error",variant:"text",onClick:u=>H(a)},{default:t(()=>l[12]||(l[12]=[i(" Cancel Order ")])),_:2},1032,["onClick"])],64)):b("",!0),a.attributes.status==="shipped"?(d(),f(c,{key:1,color:"success",variant:"text",onClick:u=>W(a)},{default:t(()=>l[13]||(l[13]=[i(" Confirm Delivery ")])),_:2},1032,["onClick"])):b("",!0),e(c,{variant:"text",to:`/orders/${a.id}`},{default:t(()=>l[14]||(l[14]=[i(" View Details ")])),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["class"]))),128)),U.value>1?(d(),y("div",Se,[e(re,{modelValue:R.value,"onUpdate:modelValue":[l[3]||(l[3]=a=>R.value=a),m],length:U.value},null,8,["modelValue","length"])])):b("",!0)],64)):(d(),f(S,{key:1,class:"text-center pa-12"},{default:t(()=>[e(T,{icon:"mdi-package-variant",size:"100",color:"grey-lighten-1",class:"mb-4"}),l[16]||(l[16]=r("h3",{class:"text-h5 mb-2"},"No Orders Found",-1)),r("p",Ne,s(v.value.status?`No ${v.value.status} orders found.`:"Start shopping to create your first order!"),1),e(c,{color:"primary",size:"large",to:"/products","prepend-icon":"mdi-shopping"},{default:t(()=>l[15]||(l[15]=[i(" Browse Products ")])),_:1})]),_:1}))],64)),e(I,{modelValue:k.value,"onUpdate:modelValue":l[5]||(l[5]=a=>k.value=a),"max-width":"400"},{default:t(()=>[e(S,null,{default:t(()=>[e(F,null,{default:t(()=>l[17]||(l[17]=[i("Confirm Payment")])),_:1}),e(A,null,{default:t(()=>{var a,u;return[i(" Are you sure you want to pay for Order #"+s((a=_.value)==null?void 0:a.id)+"? ",1),r("div",Ue," Total Amount: $"+s((u=_.value)==null?void 0:u.total_amount),1)]}),_:1}),e(B,null,{default:t(()=>[e(z),e(c,{variant:"text",onClick:l[4]||(l[4]=a=>k.value=!1)},{default:t(()=>l[18]||(l[18]=[i(" Cancel ")])),_:1}),e(c,{color:"primary",variant:"text",loading:g.value,onClick:G},{default:t(()=>l[19]||(l[19]=[i(" Pay Now ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:C.value,"onUpdate:modelValue":l[8]||(l[8]=a=>C.value=a),"max-width":"400"},{default:t(()=>[e(S,null,{default:t(()=>[e(F,null,{default:t(()=>l[20]||(l[20]=[i("Cancel Order")])),_:1}),e(A,null,{default:t(()=>{var a;return[r("p",Fe,"Are you sure you want to cancel Order #"+s((a=_.value)==null?void 0:a.id)+"?",1),e(de,{modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=u=>w.value=u),label:"Cancellation Reason",rows:"3",rules:[u=>!!u||"Reason is required"]},null,8,["modelValue","rules"])]}),_:1}),e(B,null,{default:t(()=>[e(z),e(c,{variant:"text",onClick:l[7]||(l[7]=a=>C.value=!1)},{default:t(()=>l[21]||(l[21]=[i(" No ")])),_:1}),e(c,{color:"error",variant:"text",loading:g.value,onClick:J},{default:t(()=>l[22]||(l[22]=[i(" Yes, Cancel ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ke=ge(Ae,[["__scopeId","data-v-216e4f80"]]);export{Ke as default};
