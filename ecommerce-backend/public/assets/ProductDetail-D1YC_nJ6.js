import{d as defineComponent,r as ref,c as computed,o as onMounted,b as createBlock,e as withCtx,k as createElementBlock,h as createVNode,B as useRoute,f as resolveComponent,g as openBlock,j as createBaseVNode,t as toDisplayString,n as createCommentVNode,F as Fragment,l as renderList,i as createTextVNode,q as mergeProps}from"./index-B0vVrGoP.js";import{p as productService}from"./product-CVo1VQMq.js";import{c as cartService}from"./cart-DAnYCAh8.js";import{f as favoriteService}from"./favorite-xVBpMoC3.js";import{_ as _export_sfc}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./api-D7B8soog.js";const _hoisted_1={class:"text-h4 mb-2"},_hoisted_2={class:"text-subtitle-1 mb-4 text-grey-darken-1"},_hoisted_3={class:"d-flex align-center mb-6"},_hoisted_4={class:"text-h4 font-weight-bold text-primary"},_hoisted_5={key:0,class:"text-body-1 ml-2 text-decoration-line-through"},_hoisted_6={key:0,class:"mb-6"},_hoisted_7={class:"d-flex flex-wrap gap-2"},_hoisted_8={key:1,class:"mb-6"},_hoisted_9={class:"d-flex flex-wrap gap-2"},_hoisted_10={key:0,class:"ml-1"},_hoisted_11={key:2,class:"mb-6"},_hoisted_12={class:"mb-6"},_hoisted_13={class:"d-flex align-center"},_hoisted_14={class:"mx-4 text-h6"},_hoisted_15={class:"ml-4 text-caption text-grey"},_hoisted_16={class:"text-body-1"},_hoisted_17={key:1,class:"d-flex justify-center align-center",style:{height:"400px"}},_sfc_main=defineComponent({__name:"ProductDetail",setup(__props){const route=useRoute(),product=ref(null),quantity=ref(1),selectedColor=ref(null),selectedSize=ref(null),selectedDesign=ref(null),isFavorited=ref(!1),addingToCart=ref(!1),togglingFavorite=ref(!1),activeTab=ref("details"),snackbar=ref({show:!1,color:"success",text:""}),calculateTotalPrice=computed(()=>{var t,e,l,s;let price=eval((t=product.value)==null?void 0:t.price)||0;return(e=selectedColor.value)!=null&&e.price_adjustment&&(price+=eval(selectedColor.value.price_adjustment)),(l=selectedSize.value)!=null&&l.price_adjustment&&(price+=eval(selectedSize.value.price_adjustment)),(s=selectedDesign.value)!=null&&s.price_adjustment&&(price+=eval(selectedDesign.value.price_adjustment)),(price*quantity.value).toFixed(2)}),hasAdjustments=computed(()=>{var t,e,l;return!!((t=selectedColor.value)!=null&&t.price_adjustment||(e=selectedSize.value)!=null&&e.price_adjustment||(l=selectedDesign.value)!=null&&l.price_adjustment)}),maxQuantity=computed(()=>{var t;return selectedSize.value?selectedSize.value.stock_quantity:((t=product.value)==null?void 0:t.stock_quantity)||0}),canAddToCart=computed(()=>{var t;return((t=product.value)==null?void 0:t.in_stock)&&quantity.value<=maxQuantity.value&&quantity.value>0}),selectColor=t=>{selectedColor.value=t},selectSize=t=>{selectedSize.value=t,quantity.value=1},addToCart=async()=>{if(product.value){addingToCart.value=!0;try{await cartService.addToCart(product.value.id,quantity.value),snackbar.value={show:!0,color:"success",text:"Product added to cart successfully!"}}catch(t){console.error("Failed to add to cart:",t),snackbar.value={show:!0,color:"error",text:"Failed to add product to cart"}}finally{addingToCart.value=!1}}},toggleFavorite=async()=>{if(product.value){togglingFavorite.value=!0;try{isFavorited.value?await favoriteService.removeFavorite(product.value.id):await favoriteService.addFavorite(product.value.id),isFavorited.value=!isFavorited.value}catch(t){console.error("Failed to toggle favorite:",t)}finally{togglingFavorite.value=!1}}},fetchProduct=async()=>{try{const t=parseInt(route.params.id),e=await productService.getProduct(t);product.value=e.attributes,console.log("product: ",product.value),isFavorited.value=await favoriteService.checkFavorite(t)}catch(t){console.error("Failed to fetch product:",t)}},designOptions=computed(()=>product.value.product_designs.map(t=>({id:t.id,title:t.design.design_number,price_adjustment:t.price_adjustment,design:t.design})));return onMounted(()=>{fetchProduct()}),(t,e)=>{const l=resolveComponent("v-progress-circular"),s=resolveComponent("v-row"),x=resolveComponent("v-img"),i=resolveComponent("v-card"),p=resolveComponent("v-col"),C=resolveComponent("v-alert"),m=resolveComponent("v-icon"),r=resolveComponent("v-btn"),h=resolveComponent("v-tooltip"),V=resolveComponent("v-select"),_=resolveComponent("v-card-actions"),c=resolveComponent("v-tab"),y=resolveComponent("v-tabs"),d=resolveComponent("v-window-item"),N=resolveComponent("v-window"),k=resolveComponent("v-snackbar"),b=resolveComponent("v-container");return product.value?(openBlock(),createBlock(b,{key:0},{default:withCtx(()=>[createVNode(s,null,{default:withCtx(()=>[createVNode(p,{cols:"12",md:"6"},{default:withCtx(()=>[createVNode(i,{class:"px-4 py-6"},{default:withCtx(()=>[createVNode(x,{src:product.value.image_url||"/placeholder.png",height:"400",cover:"",class:"bg-grey-lighten-2 rounded"},{placeholder:withCtx(()=>[createVNode(s,{class:"fill-height ma-0",align:"center",justify:"center"},{default:withCtx(()=>[createVNode(l,{indeterminate:"",color:"primary"})]),_:1})]),_:1},8,["src"])]),_:1})]),_:1}),createVNode(p,{cols:"12",md:"6"},{default:withCtx(()=>[createVNode(i,{class:"pa-6"},{default:withCtx(()=>{var a,g,f;return[createBaseVNode("h1",_hoisted_1,toDisplayString(product.value.product_name),1),createBaseVNode("p",_hoisted_2,toDisplayString(product.value.description),1),createBaseVNode("div",_hoisted_3,[createBaseVNode("span",_hoisted_4," $"+toDisplayString(calculateTotalPrice.value),1),hasAdjustments.value?(openBlock(),createElementBlock("span",_hoisted_5," $"+toDisplayString(product.value.price),1)):createCommentVNode("",!0)]),createVNode(C,{type:product.value.stock_quantity>0?"success":"warning",text:product.value.stock_quantity>0?"In Stock":"Out of Stock",class:"mb-4",density:"compact",variant:"tonal"},null,8,["type","text"]),(a=product.value.product_colors)!=null&&a.length?(openBlock(),createElementBlock("div",_hoisted_6,[e[8]||(e[8]=createBaseVNode("h3",{class:"text-h6 mb-3"},"Color",-1)),createBaseVNode("div",_hoisted_7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(product.value.product_colors,o=>(openBlock(),createBlock(h,{key:o.id,text:o.color.description,location:"top"},{activator:withCtx(({props:n})=>{var u;return[createVNode(r,mergeProps({ref_for:!0},n,{style:{backgroundColor:o.color.rgb},variant:((u=selectedColor.value)==null?void 0:u.id)===o.id?"elevated":"outlined",class:"color-btn",width:"40",height:"40",onClick:v=>selectColor(o)}),{default:withCtx(()=>{var v;return[((v=selectedColor.value)==null?void 0:v.id)===o.id?(openBlock(),createBlock(m,{key:0,color:"white",size:"small"},{default:withCtx(()=>e[7]||(e[7]=[createTextVNode(" mdi-check ")])),_:1})):createCommentVNode("",!0)]}),_:2},1040,["style","variant","onClick"])]}),_:2},1032,["text"]))),128))])])):createCommentVNode("",!0),(g=product.value.product_sizes)!=null&&g.length?(openBlock(),createElementBlock("div",_hoisted_8,[e[9]||(e[9]=createBaseVNode("h3",{class:"text-h6 mb-3"},"Size",-1)),createBaseVNode("div",_hoisted_9,[(openBlock(!0),createElementBlock(Fragment,null,renderList(product.value.product_sizes,o=>{var n;return openBlock(),createBlock(r,{key:o.id,variant:((n=selectedSize.value)==null?void 0:n.id)===o.id?"elevated":"outlined",disabled:o.stock_quantity===0,onClick:u=>selectSize(o)},{default:withCtx(()=>[createTextVNode(toDisplayString(o.size.size_name)+" ",1),o.price_adjustment?(openBlock(),createElementBlock("small",_hoisted_10," (+$"+toDisplayString(o.price_adjustment)+") ",1)):createCommentVNode("",!0)]),_:2},1032,["variant","disabled","onClick"])}),128))])])):createCommentVNode("",!0),(f=product.value.product_designs)!=null&&f.length?(openBlock(),createElementBlock("div",_hoisted_11,[e[10]||(e[10]=createBaseVNode("h3",{class:"text-h6 mb-3"},"Design",-1)),createVNode(V,{modelValue:selectedDesign.value,"onUpdate:modelValue":e[0]||(e[0]=o=>selectedDesign.value=o),items:designOptions.value,"item-title":"title","item-value":"id",label:"Select Design",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_12,[e[11]||(e[11]=createBaseVNode("h3",{class:"text-h6 mb-3"},"Quantity",-1)),createBaseVNode("div",_hoisted_13,[createVNode(r,{icon:"mdi-minus",variant:"outlined",disabled:quantity.value<=1,onClick:e[1]||(e[1]=o=>quantity.value--)},null,8,["disabled"]),createBaseVNode("span",_hoisted_14,toDisplayString(quantity.value),1),createVNode(r,{icon:"mdi-plus",variant:"outlined",disabled:quantity.value>=maxQuantity.value,onClick:e[2]||(e[2]=o=>quantity.value++)},null,8,["disabled"]),createBaseVNode("span",_hoisted_15,toDisplayString(maxQuantity.value)+" available ",1)])]),createVNode(_,{class:"pa-0"},{default:withCtx(()=>[createVNode(r,{color:"primary",size:"large",block:"",loading:addingToCart.value.value,disabled:!canAddToCart.value,class:"mb-2",onClick:addToCart},{default:withCtx(()=>e[12]||(e[12]=[createTextVNode(" Add to Cart ")])),_:1},8,["loading","disabled"])]),_:1}),createVNode(_,{class:"ps-0"},{default:withCtx(()=>[createVNode(r,{color:isFavorited.value?"error":void 0,variant:isFavorited.value?"flat":"outlined",size:"large",block:"",loading:toggleFavorite.value,onClick:toggleFavorite},{default:withCtx(()=>[createVNode(m,{icon:isFavorited.value?"mdi-heart":"mdi-heart-outline",class:"mr-2"},null,8,["icon"]),createTextVNode(" "+toDisplayString(isFavorited.value?"Remove from Favorites":"Add to Favorites"),1)]),_:1},8,["color","variant","loading"])]),_:1})]}),_:1}),createVNode(i,{class:"mt-4 pa-6"},{default:withCtx(()=>[createVNode(y,{modelValue:activeTab.value,"onUpdate:modelValue":e[3]||(e[3]=a=>activeTab.value=a)},{default:withCtx(()=>[createVNode(c,{value:"details"},{default:withCtx(()=>e[13]||(e[13]=[createTextVNode("Details")])),_:1}),createVNode(c,{value:"shipping"},{default:withCtx(()=>e[14]||(e[14]=[createTextVNode("Shipping")])),_:1}),createVNode(c,{value:"returns"},{default:withCtx(()=>e[15]||(e[15]=[createTextVNode("Returns")])),_:1})]),_:1},8,["modelValue"]),createVNode(N,{modelValue:activeTab.value,"onUpdate:modelValue":e[4]||(e[4]=a=>activeTab.value=a),class:"mt-4"},{default:withCtx(()=>[createVNode(d,{value:"details"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_16,toDisplayString(product.value.description),1)]),_:1}),createVNode(d,{value:"shipping"},{default:withCtx(()=>e[16]||(e[16]=[createBaseVNode("div",{class:"text-body-1"},[createBaseVNode("h4",{class:"text-h6 mb-2"},"Shipping Information"),createBaseVNode("ul",{class:"pl-4"},[createBaseVNode("li",null,"Free shipping on orders over $50"),createBaseVNode("li",null,"Standard delivery: 3-5 business days"),createBaseVNode("li",null,"Express delivery: 1-2 business days")])],-1)])),_:1}),createVNode(d,{value:"returns"},{default:withCtx(()=>e[17]||(e[17]=[createBaseVNode("div",{class:"text-body-1"},[createBaseVNode("h4",{class:"text-h6 mb-2"},"Return Policy"),createBaseVNode("p",null,"30-day return policy for unworn items in original packaging.")],-1)])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),createVNode(k,{modelValue:snackbar.value.show,"onUpdate:modelValue":e[6]||(e[6]=a=>snackbar.value.show=a),color:snackbar.value.color,timeout:3e3},{actions:withCtx(()=>[createVNode(r,{color:"white",variant:"text",onClick:e[5]||(e[5]=a=>snackbar.value.show=!1)},{default:withCtx(()=>e[18]||(e[18]=[createTextVNode(" Close ")])),_:1})]),default:withCtx(()=>[createTextVNode(toDisplayString(snackbar.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})):(openBlock(),createElementBlock("div",_hoisted_17,[createVNode(l,{indeterminate:"",color:"primary"})]))}}}),ProductDetail=_export_sfc(_sfc_main,[["__scopeId","data-v-e4c6b87d"]]);export{ProductDetail as default};
